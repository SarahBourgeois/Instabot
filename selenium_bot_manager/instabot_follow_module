import helpers.filehelper as filehelper
import configuration.getconfig as getconfig
import Ui.console.textdisplay as textdisplay
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.service import Service
from webdriver_manager.chrome import ChromeDriverManager
from webdriver_manager.firefox import GeckoDriverManager
from selenium.webdriver.chrome.options import Options
import time
import re

def is_already_follow(driver):
    try: 
        global is_follow
        is_follow_input = driver.find_element(by=By.XPATH, value="/html/body/div[6]/div[3]/div/article/div/div[2]/div/div/div[1]/div/header/div[2]/div[1]/div[2]/button").get_attribute("innerHTML")
        pattern = "\">(.*?)\</d"
        follow_response = re.search(pattern, is_follow_input).group(1)
        if(follow_response == 'AbonnÃ©(e)'):
            is_follow = True
        else:
            is_follow = False
    except:
        print("Can't know if already follow or not")

def register_followed_person(driver):
    follow = driver.find_element_by_css_selector("body > div.RnEpo._Yhr4 > div.pbNvD.QZZGH.bW6vo > div > article > div > div.HP0qD > div > div > div.UE9AK > div > header > div.o-MQd.z8cbW > div.PQo_0.RqtMr > div.e1e1d > div > span > a").text
    filehelper.registerData(follow)
# already copy paste

def follow(driver):
    if(is_follow == False):
        follow_element = driver.find_element(by=By.XPATH, value='/html/body/div[6]/div[3]/div/article/div/div[2]/div/div/div[1]/div/header/div[2]/div[1]/div[2]/button/div')
        follow_element.click()
        register_followed_person(driver)